@model IEnumerable<Forum.Entity.Models.Question>

@{
    ViewData["Title"] = "Ana Sayfa";
}

<h2>Forum Konuları</h2>
<hr />

@if (User.Identity.IsAuthenticated)
{
    <p>
        <a asp-controller="Question" asp-action="Create" class="btn btn-success mb-3">Yeni Konu Aç</a>
    </p>
}
else
{
    <p class="alert alert-info">Yeni konu açmak için lütfen <a asp-controller="Account" asp-action="Login">giriş yapın</a>.</p>
}


<table class="table table-hover forum-table border shadow-sm">
    <thead class="table-primary">
        <tr>
            <th>Konu Başlığı</th>
            <th style="width: 15%;">Yazar</th>
            <th style="width: 15%;">Cevap Sayısı</th>
            <th style="width: 15%;">Son Aktivite</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">

                    <span class="badge badge-dark px-2 py-1">
                        <i class="fas fa-layer-group mr-1"></i> @(item.Category?.Name ?? "Genel")
                    </span>
                    <small class="text-muted">@item.CreatedDate.ToString("dd.MM.yyyy")</small>
                </div>
                <div class="card-body">
                    <h5 class="font-weight-bold text-dark">
                        <a href="/Home/Details/@item.Id" class="text-decoration-none text-dark">@item.Title</a>
                    </h5>

                    <p>
                        @if (item.Description.Length > 100)
                        {
                            @item.Description.Substring(0, 100) <text>...</text>
                        }
                        else
                        {
                            @item.Description
                        }
                    </p>

                    <hr>

                    <div class="d-flex justify-content-between align-items-center">
                        <div class="small">
                            <i class="fas fa-user text-gray-400"></i>
                            <span class="font-weight-bold text-secondary ml-1">
                                @(item.User?.Name ?? item.User?.UserName ?? "Misafir")
                            </span>
                        </div>

                        <div>
                            <span class="mr-3 small text-gray-600">
                                <i class="fas fa-comment"></i> @(item.Comments?.Count ?? 0) Yorum
                            </span>
                            <a href="/Home/Details/@item.Id" class="btn btn-sm btn-primary">
                                Oku &rarr;
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </tbody>
</table>